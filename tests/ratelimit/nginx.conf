daemon off;
error_log logs/error.log debug;
pid logs/nginx.pid;

events {
    worker_connections 64;
}

http {
    access_log logs/access.log;

    server {
        listen 8888;

        # Rate limited endpoint (5 requests per second)
        location /api {
            ratelimit;
            ratelimit_rate 5r/s;
            return 200 "api ok\n";
        }

        # Rate limited with burst (3 req/s + 2 burst = 5 total per window)
        location /burst {
            ratelimit;
            ratelimit_rate 3r/s;
            ratelimit_burst 2;
            return 200 "burst ok\n";
        }

        # Very low limit for testing (2 req/s)
        location /strict {
            ratelimit;
            ratelimit_rate 2r/s;
            return 200 "strict ok\n";
        }

        # Non-rate-limited endpoint
        location / {
            return 200 "ok\n";
        }
    }
}
