daemon off;
error_log logs/error.log debug;
pid logs/nginx.pid;

events {
    worker_connections 64;
}

http {
    access_log logs/access.log;

    # Mock upstream
    upstream backend {
        server 127.0.0.1:19001;
    }

    server {
        listen 8888;

        # Test with return directive (use default header X-Request-ID)
        location /return-test {
            request_id_response on;
            return 200 "ok\n";
        }

        # Test with proxy
        location /proxy-test {
            request_id_response on;
            proxy_pass http://backend/;
        }

        # Test disabled (for comparison)
        location /disabled {
            return 200 "no request_id\n";
        }

        # Test $ngz_request_id variable
        location /variable-test {
            request_id_response on;
            return 200 "id:$ngz_request_id\n";
        }
    }
}
