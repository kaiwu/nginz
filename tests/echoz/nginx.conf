daemon off;
error_log logs/error.log info;
pid logs/nginx.pid;

events {
    worker_connections 64;
}

http {
    access_log logs/access.log;

    server {
        listen 8888;

        # Basic echoz - outputs text with newline
        location /echo {
            echoz "hello world";
        }

        # Multiple echoz commands
        location /multi {
            echoz "line1";
            echoz "line2";
            echoz "line3";
        }

        # echozn - no newline
        location /echon {
            echozn "no";
            echozn "newline";
        }

        # echoz_duplicate - repeat string N times
        location /duplicate {
            echoz_duplicate 3 "abc";
        }

        # Variable interpolation
        location /vars {
            echoz "method: $request_method";
            echoz "uri: $uri";
        }

        # echoz_exec - internal redirect to named location
        location /exec {
            echoz_exec @target;
        }

        location @target {
            echoz "redirected!";
        }

        # echoz_exec - internal redirect to regular location
        location /exec2 {
            echoz_exec /echo;
        }

        # Request body echo
        location /body {
            echoz_read_request_body;
            echoz "body received:";
            echoz_request_body;
        }

        # Subrequest
        location /main {
            echoz "before";
            echoz_location_async /sub;
            echoz "after";
        }

        location /sub {
            echoz "sub-response";
        }

        # Empty response (just headers)
        location /empty {
            echoz;
        }

        # Multiple arguments
        location /args {
            echoz hello world "from nginx";
        }
    }
}
