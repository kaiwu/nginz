daemon off;
error_log logs/error.log info;
pid logs/nginx.pid;

events {
    worker_connections 64;
}

http {
    access_log logs/access.log;

    server {
        listen 8888;

        # Validated endpoint - requires name (string) and age (number >= 0)
        location /api/users {
            jsonschema;
            jsonschema_schema '{"type":"object","required":["name","email"],"properties":{"name":{"type":"string","minLength":1},"email":{"type":"string"},"age":{"type":"number","minimum":0}}}';
            return 200 '{"status":"ok"}';
        }

        # Simple type validation
        location /api/simple {
            jsonschema;
            jsonschema_schema '{"type":"object"}';
            return 200 '{"status":"ok"}';
        }

        # Non-validated endpoint
        location / {
            return 200 "ok\n";
        }
    }
}
