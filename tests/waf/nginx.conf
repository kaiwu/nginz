daemon off;
error_log logs/error.log debug;
pid logs/nginx.pid;

events {
    worker_connections 64;
}

http {
    access_log logs/access.log;

    server {
        listen 8888;

        # Default location with WAF enabled in block mode
        location /api {
            waf on;
            waf_mode block;
            waf_sqli on;
            waf_xss on;
            echozn "api response";
        }

        # Location with WAF in detect mode (logs but doesn't block)
        location /detect {
            waf on;
            waf_mode detect;
            waf_sqli on;
            waf_xss on;
            echozn "detect response";
        }

        # Location with WAF disabled
        location /disabled {
            waf off;
            echozn "disabled response";
        }

        # Location with only SQLi detection
        location /sqli-only {
            waf on;
            waf_mode block;
            waf_sqli on;
            waf_xss off;
            echozn "sqli-only response";
        }

        # Location with only XSS detection
        location /xss-only {
            waf on;
            waf_mode block;
            waf_sqli off;
            waf_xss on;
            echozn "xss-only response";
        }

        # Location with body checking enabled
        location /body {
            waf on;
            waf_mode block;
            waf_sqli on;
            waf_xss on;
            waf_check_body on;
            echozn "body response";
        }

        # Clean endpoint for normal requests
        location /clean {
            waf on;
            waf_mode block;
            echozn "clean response";
        }
    }
}
